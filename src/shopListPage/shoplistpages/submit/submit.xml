<from report-submit="{{true}}" bindsubmit="upFormId">
  <view wx:if="{{ !need_pay }}">
    <view class="p20">
      <view class="br18 bgfff goods p30 pr">
        <view catchtap="chooseAddress"
              class="address pr">
          <image lazy-load="{{true}}"
                 mode="widthFix"
                 src="https://teach-1258261086.cos.ap-guangzhou.myqcloud.com/image/admin/background/add_address1.png"></image>
          <view wx:if="{{ addressInfo }}"
                class="address-s f26 c3a3a3a">
            <view class="a-s-t">
              <text class="iconfont icon-dizhi f26">收货人: {{ addressInfo.userName }}</text>
              <text class="f26">{{ addressInfo.telNumber }}</text>
            </view>
            <view class="ell2">
              收货地址: {{ addressInfo.provinceName }}{{ addressInfo.cityName }}{{ addressInfo.countyName }}{{ addressInfo.detailInfo }}
            </view>
          </view>
          <view wx:if="{{ needSetting }}"
                class="open-setting">
            <button catchtap="openSetting">开启授权</button>
          </view>
        </view>
        <scroll-view scroll-y
                     style="max-height: 640rpx;">
          <view class="goods-list br8 p20 f28 c666"
                wx:key="*45"
                wx:for="{{ info }}">
            <image src="{{ item.img }}"
                   class="br8"
                   mode="aspectFit"></image>
            <view class="flex1">
              <view>{{ item.title }}</view>
              <veiw wx:if="{{ item.label != -1 }}">{{ item.label }}:{{ item.sku ? item.sku.value : item.value  }}</veiw>
            </view>
            <view class="ml10">X{{ item.count }}</view>
          </view>
        </scroll-view>
        <view class="p20 f28 c444 bd1">
          <view>共计<text class="fw7">{{ allCount }}件</text>商品</view>

          <view class="money mt30">
            <text>商品总价</text>
            <text>¥{{ Allmoney }}</text>
          </view>

          <view class="money">
            <text>运费</text>
            <text>¥{{ maxFreight }}</text>
          </view>
        </view>
        <view  class="f28 c444 fw7 tar mt10"><text wx:if="{{ discount_name.length >= 1 }}">({{  discount_name }})</text>共计需要付款：￥{{ Allmoney * 1 + maxFreight * 1 }}</view>
      </view>
    </view>
    <view class="submit bt1 f24 c444">
      <text>共{{ allCount }}件，</text>
      <text class="f34 fw7">合计：¥{{ Allmoney * 1 + maxFreight * 1 }}</text>
      <button catchtap="submit" class="f34 cfff">提交订单</button>
    </view>
  </view>
  <view wx:else class="p20 pay-success">
    <view class="bgfff br8">
      <image src="https://teach-1258261086.cos.ap-guangzhou.myqcloud.com/image/admin/background/pay_success.png"></image>
      <view class="c444 fw7">支付成功！</view>
      <button open-type="submit" catchtap="gohome">返回商城首页</button>
    </view>
  </view>
</from>
<!--错误弹窗-->
<import src="/template/template"></import>
<template wx:if="{{ toast.show }}" is="showToast" data="{{ ...toast }}"></template>
