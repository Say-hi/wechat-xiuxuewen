{"version":3,"sources":["reservationPage/pagesseven/reservation/reservation.js"],"names":["app","getApp","bmap","require","Page","data","title","testImg","onShareAppMessage","gs","path","open_site","e","console","log","detail","authSetting","wx","showToast","setData","openType","Bmap","choose_site","that","chooseLocation","success","res","address","latitude","longitude","site","_this","BMap","BMapWX","ak","weather","fail","type","Date","getHours","weatherInfo","originalData","results","weatherPic","weather_data","replace","location","regeocoding","addressInfo","err","chooseCity","cancel","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"reservation.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst bmap = require('../../../utils/bmap-wx')\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    title: 'reservation',\n    testImg: app.data.testImg\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText') || '绣学问，真纹绣',\n      path: `/pages/index/index`\n    }\n  },\n  /**\n   * 地址授权\n   * @param e\n   */\n  open_site (e) {\n    console.log('setting')\n    if (e.detail.authSetting['scope.userLocation']) {\n      wx.showToast({\n        title: '授权成功'\n      })\n      this.setData({\n        openType: null\n      })\n      this.Bmap(this)\n    }\n  },\n  choose_site () {\n    console.log('choose')\n    let that = this\n    if (!this.data.openType) {\n      wx.chooseLocation({\n        success (res) {\n          that.setData({\n            address: res.address,\n            latitude: res.latitude,\n            longitude: res.longitude\n          }, that.Bmap(that, `${res.longitude},${res.latitude}`))\n        }\n      })\n    }\n  },\n  /**\n   * 百度地图函数\n   * @param that\n   * @constructor\n   */\n  Bmap (that, site) {\n    let _this = this\n    let BMap = new bmap.BMapWX({\n      ak: 'RBTsmFCaerZ25VkuGhpSIZa5lyC36BcV'\n    })\n    BMap.weather({\n      fail (data) {\n        that.setData({\n          openType: 'openSetting'\n        })\n        console.log('fail', data)\n      },\n      success (data) {\n        let type = (new Date().getHours() > 18 || new Date().getHours() < 6) ? 'nightPictureUrl' : 'dayPictureUrl'\n        that.setData({\n          weatherInfo: data.originalData.results[0],\n          weatherPic: data.originalData.results[0].weather_data[0][type].replace('http://', 'https://')\n        })\n      },\n      location: site || null\n    }, _this)\n    BMap.regeocoding({\n      location: site || null,\n      success (res) {\n        that.setData({\n          addressInfo: res\n        })\n      },\n      fail (err) {\n        console.log(err)\n      }\n    })\n  },\n  /**\n   * 选择城市\n   */\n  chooseCity () {\n    let that = this\n    wx.chooseLocation({\n      success (res) {\n        let site = res.longitude + ',' + res.latitude\n        that.Bmap(that, site)\n      },\n      cancel (res) {\n        console.log(res)\n      },\n      fail (res) {\n        console.log(res)\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.Bmap(this)\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}