{"version":3,"sources":["feedbackPage/pagesfour/feedback/feedback.js"],"names":["app","getApp","Page","data","imgDomain","testImg","imgArr","title","onShareAppMessage","gs","path","formSubmit","e","that","detail","value","content","setToast","options","id","wxrequest","url","getUrl","homeReport","user_id","userid","style","obj_id","reason","success","res","wx","hideLoading","status","showToast","desc","contact","userFeedback","setTimeout","navigateBack","del","splice","currentTarget","dataset","index","setData","showImg","upImg","wxUploadImg","console","log","push","onLoad","setBar","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"feedback.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    imgDomain: app.data.imgDomain,\n    testImg: app.data.testImg,\n    imgArr: [],\n    title: 'feedback'\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText') || '绣学问，真纹绣',\n      path: `/pages/index/index`\n    }\n  },\n  formSubmit (e) {\n    let that = this\n    if (!e.detail.value.content) return app.setToast(this, {content: '请输入反馈内容'})\n    if (that.data.options.id) {\n      return app.wxrequest({\n        url: app.getUrl().homeReport,\n        data: {\n          user_id: that.data.options.userid,\n          style: that.data.options.style,\n          obj_id: that.data.options.id,\n          title: that.data.options.title,\n          reason: e.detail.value.content\n        },\n        success (res) {\n          wx.hideLoading()\n          if (res.data.status === 200) {\n            wx.showToast({\n              title: '反馈成功'\n            })\n          } else {\n            app.setToast(that, {content: res.data.desc})\n          }\n        }\n      })\n    } else if (!e.detail.value.contact) return app.setToast(this, {content: '请输入联系方式'})\n    app.wxrequest({\n      url: app.getUrl().userFeedback,\n      data: {\n        user_id: app.gs('userInfoAll').id,\n        desc: e.detail.value.content,\n        contact: e.detail.value.contact\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          wx.showToast({\n            title: '反馈成功'\n          })\n          setTimeout(() => {\n            wx.navigateBack()\n          }, 1200)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  del (e) {\n    this.data.imgArr.splice(e.currentTarget.dataset.index, 1)\n    this.setData({\n      imgArr: this.data.imgArr\n    })\n  },\n  showImg (e) {\n    app.showImg(e)\n  },\n  upImg (e) {\n    let that = this\n    app.wxUploadImg((res) => {\n      console.log(res)\n      that.data.imgArr.push({\n        url: that.data.imgDomain + '/' + res.path,\n        id: res.id\n      })\n      that.setData({\n        imgArr: that.data.imgArr\n      })\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    this.setData({\n      options\n    })\n    if (options.id) app.setBar('举报')\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}