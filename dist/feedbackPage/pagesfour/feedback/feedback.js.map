{"version":3,"sources":["feedbackPage/pagesfour/feedback/feedback.js"],"names":["app","getApp","Page","data","imgDomain","testImg","imgArr","title","onShareAppMessage","gs","t","path","imageUrl","g","formSubmit","e","that","detail","value","content","setToast","options","id","wxrequest","url","getUrl","homeReport","user_id","userid","style","obj_id","reason","success","res","wx","hideLoading","status","showToast","desc","contact","userFeedback","setTimeout","navigateBack","del","splice","currentTarget","dataset","index","setData","showImg","upImg","wxUploadImg","console","log","push","onLoad","setBar","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"feedback.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    imgDomain: app.data.imgDomain,\n    testImg: app.data.testImg,\n    imgArr: [],\n    title: 'feedback'\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText').t || '绣学问，真纹绣',\n      path: `/pages/index/index`,\n      imageUrl: app.gs('shareText').g\n    }\n  },\n  formSubmit (e) {\n    let that = this\n    if (!e.detail.value.content) return app.setToast(this, {content: '请输入反馈内容'})\n    if (that.data.options.id) {\n      return app.wxrequest({\n        url: app.getUrl().homeReport,\n        data: {\n          user_id: that.data.options.userid,\n          style: that.data.options.style,\n          obj_id: that.data.options.id,\n          title: that.data.options.title,\n          reason: e.detail.value.content\n        },\n        success (res) {\n          wx.hideLoading()\n          if (res.data.status === 200) {\n            wx.showToast({\n              title: '反馈成功'\n            })\n          } else {\n            app.setToast(that, {content: res.data.desc})\n          }\n        }\n      })\n    } else if (!e.detail.value.contact) return app.setToast(this, {content: '请输入联系方式'})\n    app.wxrequest({\n      url: app.getUrl().userFeedback,\n      data: {\n        user_id: app.gs('userInfoAll').id,\n        desc: e.detail.value.content,\n        contact: e.detail.value.contact\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          wx.showToast({\n            title: '反馈成功'\n          })\n          setTimeout(() => {\n            wx.navigateBack()\n          }, 1200)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  del (e) {\n    this.data.imgArr.splice(e.currentTarget.dataset.index, 1)\n    this.setData({\n      imgArr: this.data.imgArr\n    })\n  },\n  showImg (e) {\n    app.showImg(e)\n  },\n  upImg (e) {\n    let that = this\n    app.wxUploadImg((res) => {\n      console.log(res)\n      that.data.imgArr.push({\n        url: that.data.imgDomain + '/' + res.path,\n        id: res.id\n      })\n      that.setData({\n        imgArr: that.data.imgArr\n      })\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    this.setData({\n      options\n    })\n    if (options.id) app.setBar('举报')\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}