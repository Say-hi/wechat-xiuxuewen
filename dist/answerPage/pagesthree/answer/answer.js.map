{"version":3,"sources":["answerPage/pagesthree/answer/answer.js"],"names":["app","getApp","proportion","wx","getSystemInfoSync","windowWidth","HEIGHT","Page","data","page","currentIndex","height","opacity","videoTab","t","lists","onShareAppMessage","title","gs","path","imageUrl","g","getData","getList","pageScrollTo","scrollTop","chooseIndex","e","setData","currentTarget","dataset","index","err","onPageScroll","search","that","ask","user_id","id","wxrequest","url","getUrl","question","questionProblemHot","questionProblemMy","success","res","hideLoading","status","v","create_time","momentFormat","images","split","concat","more","pre_page","length","searchText","setToast","content","desc","onReachBottom","getCount","questionProblemMyCount","hasInfo","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"answer.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst proportion = wx.getSystemInfoSync().windowWidth / 750\nconst HEIGHT = 100\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    page: 0,\n    currentIndex: 0,\n    height: HEIGHT,\n    opacity: 1,\n    videoTab: [\n      {\n        t: '热门提问'\n      },\n      {\n        t: '最新提问'\n      },\n      {\n        t: '我的提问'\n      }\n    ],\n    lists: []\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText').t || '绣学问，真纹绣',\n      path: `/pages/index/index`,\n      imageUrl: app.gs('shareText').g\n    }\n  },\n  getData () {\n    this.getList()\n    wx.pageScrollTo({\n      scrollTop: 0\n    })\n  },\n  chooseIndex (e) {\n    this.data.page = 0\n    this.data.lists = []\n    try {\n      this.setData({\n        currentIndex: e.currentTarget.dataset.index\n      }, this.getData)\n    } catch (err) {\n      this.setData({\n        currentIndex: 2\n      }, this.getData)\n    }\n  },\n  onPageScroll (e) {\n    let height = (HEIGHT - e.scrollTop * proportion) >= 100 ? 100 : (HEIGHT - e.scrollTop * proportion)\n    this.setData({\n      height,\n      opacity: height <= 0 ? 0 : height / HEIGHT\n    })\n  },\n  getList (search) {\n    let that = this\n    let data = {}\n    if (search) {\n      this.data.page = 0\n      this.data.lists = []\n      this.setData({\n        currentIndex: -1,\n        search\n      })\n      data = {\n        // user_id: app.gs('userInfoAll').id,\n        page: ++this.data.page,\n        ask: search\n      }\n    } else if (this.data.currentIndex * 1 === 1) {\n      data = {\n        page: ++this.data.page\n      }\n    } else if (this.data.currentIndex * 1 === 2) {\n      data = {\n        user_id: app.gs('userInfoAll').id,\n        page: ++this.data.page\n      }\n    } else {\n      data = {\n        page: ++this.data.page\n      }\n    }\n    app.wxrequest({\n      url: (this.data.currentIndex * 1 === 1 || this.data.currentIndex * 1 === -1) ? app.getUrl().question : this.data.currentIndex * 1 === 0 ? app.getUrl().questionProblemHot : app.getUrl().questionProblemMy,\n      data,\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          for (let v of res.data.data.lists) {\n            v.create_time = app.momentFormat(v.create_time * 1000, 'YYYY年MM月DD日 HH:mm:ss')\n            v.images = v.images ? v.images.split(',') : []\n          }\n          that.setData({\n            lists: that.data.lists.concat(res.data.data.lists),\n            more: res.data.data.pre_page > res.data.data.lists.length ? 0 : 1\n          })\n          app.data.searchText = null\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  onReachBottom () {\n    if (this.data.more) {\n      if (this.data.search) {\n        this.getList(this.data.search)\n      } else {\n        this.getList()\n      }\n    } else app.setToast(this, {content: '没有更多内容啦'})\n  },\n  getCount () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().questionProblemMyCount,\n      data: {\n        user_id: app.gs('userInfoAll').id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          that.setData({\n            hasInfo: res.data.data > 0 ? true : null\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getList()\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    if (app.data.searchText) this.getList(app.data.searchText)\n    this.getCount()\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}