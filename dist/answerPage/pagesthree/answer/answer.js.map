{"version":3,"sources":["answerPage/pagesthree/answer/answer.js"],"names":["app","getApp","proportion","wx","getSystemInfoSync","windowWidth","HEIGHT","Page","data","page","currentIndex","height","opacity","videoTab","t","lists","onShareAppMessage","title","gs","path","getData","getList","pageScrollTo","scrollTop","chooseIndex","e","setData","currentTarget","dataset","index","err","onPageScroll","search","that","ask","user_id","id","wxrequest","url","getUrl","question","questionProblemHot","questionProblemMy","success","res","hideLoading","status","v","create_time","momentFormat","images","split","concat","more","pre_page","length","searchText","setToast","content","desc","onReachBottom","getCount","questionProblemMyCount","hasInfo","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"answer.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst proportion = wx.getSystemInfoSync().windowWidth / 750\nconst HEIGHT = 100\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    page: 0,\n    currentIndex: 0,\n    height: HEIGHT,\n    opacity: 1,\n    videoTab: [\n      {\n        t: '热门提问'\n      },\n      {\n        t: '最新提问'\n      },\n      {\n        t: '我的提问'\n      }\n    ],\n    lists: []\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText') || '绣学问，真纹绣',\n      path: `/pages/index/index`\n    }\n  },\n  getData () {\n    this.getList()\n    wx.pageScrollTo({\n      scrollTop: 0\n    })\n  },\n  chooseIndex (e) {\n    this.data.page = 0\n    this.data.lists = []\n    try {\n      this.setData({\n        currentIndex: e.currentTarget.dataset.index\n      }, this.getData)\n    } catch (err) {\n      this.setData({\n        currentIndex: 2\n      }, this.getData)\n    }\n  },\n  onPageScroll (e) {\n    let height = (HEIGHT - e.scrollTop * proportion) >= 100 ? 100 : (HEIGHT - e.scrollTop * proportion)\n    this.setData({\n      height,\n      opacity: height <= 0 ? 0 : height / HEIGHT\n    })\n  },\n  getList (search) {\n    let that = this\n    let data = {}\n    if (search) {\n      this.data.page = 0\n      this.data.lists = []\n      this.setData({\n        currentIndex: -1,\n        search\n      })\n      data = {\n        // user_id: app.gs('userInfoAll').id,\n        page: ++this.data.page,\n        ask: search\n      }\n    } else if (this.data.currentIndex * 1 === 1) {\n      data = {\n        page: ++this.data.page\n      }\n    } else if (this.data.currentIndex * 1 === 2) {\n      data = {\n        user_id: app.gs('userInfoAll').id,\n        page: ++this.data.page\n      }\n    } else {\n      data = {\n        page: ++this.data.page\n      }\n    }\n    app.wxrequest({\n      url: (this.data.currentIndex * 1 === 1 || this.data.currentIndex * 1 === -1) ? app.getUrl().question : this.data.currentIndex * 1 === 0 ? app.getUrl().questionProblemHot : app.getUrl().questionProblemMy,\n      data,\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          for (let v of res.data.data.lists) {\n            v.create_time = app.momentFormat(v.create_time * 1000, 'YYYY年MM月DD日 HH:mm:ss')\n            v.images = v.images ? v.images.split(',') : []\n          }\n          that.setData({\n            lists: that.data.lists.concat(res.data.data.lists),\n            more: res.data.data.pre_page > res.data.data.lists.length ? 0 : 1\n          })\n          app.data.searchText = null\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  onReachBottom () {\n    if (this.data.more) {\n      if (this.data.search) {\n        this.getList(this.data.search)\n      } else {\n        this.getList()\n      }\n    } else app.setToast(this, {content: '没有更多内容啦'})\n  },\n  getCount () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().questionProblemMyCount,\n      data: {\n        user_id: app.gs('userInfoAll').id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          that.setData({\n            hasInfo: res.data.data > 0 ? true : null\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    this.getList()\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    if (app.data.searchText) this.getList(app.data.searchText)\n    this.getCount()\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}