{"version":3,"sources":["answerPage/pagesthree/answerDetail2/answerDetail2.js"],"names":["app","getApp","Page","data","rIndex","page","testImg","commentArr","getMoreNext","getEvaluate","replyOperation","e","replyFocus","setData","replyName","currentTarget","dataset","name","cindex","answer_is_teach","teach","receiver_user_id","id","replyBlur","setTimeout","replyConfirm","detail","value","length","setToast","that","content","wxrequest","url","getUrl","questionDiscussSub","question_id","options","user_id","gs","receiver_id","info","comment","success","res","wx","hideLoading","status","push","reply_user_id","reply_nickname","nickname","reply_is_teach","is_teach","answer_nickname","desc","collectO","userCollect","collect","then","collect_count","console","log","err","onShareAppMessage","title","path","getDetail","questionDetail","images","split","create_time","momentFormat","is_collect","questionDiscuss","concat","lists","more","pre_page","showImg","index","onLoad","wxlogin","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"answerDetail2.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    rIndex: -1,\n    page: 0,\n    testImg: app.data.testImg,\n    commentArr: []\n  },\n  getMoreNext () {\n    this.getEvaluate()\n  },\n  // 用户回复操作\n  replyOperation (e) {\n    if (this.data.replyFocus) return\n    this.setData({\n      replyName: e.currentTarget.dataset.name,\n      rIndex: e.currentTarget.dataset.cindex,\n      answer_is_teach: e.currentTarget.dataset.teach || 0,\n      receiver_user_id: e.currentTarget.dataset.name === '题主' ? 0 : e.currentTarget.dataset.id || 0,\n      replyFocus: true\n    })\n  },\n  replyBlur () {\n    setTimeout(() => {\n      this.setData({\n        rIndex: -1,\n        replyFocus: false\n      })\n    }, 200)\n  },\n  replyConfirm (e) {\n    if (!e.detail.value.length) return app.setToast(that, {content: '请输入您的回复内容'})\n    let that = this\n    // let index = that.data.rIndex\n    app.wxrequest({\n      url: app.getUrl().questionDiscussSub,\n      data: {\n        question_id: that.data.options.id,\n        user_id: app.gs('userInfoAll').id,\n        receiver_id: that.data.info.user_id,\n        comment: e.detail.value,\n        receiver_user_id: that.data.rIndex * 1 === 0.5 ? 0 : that.data.commentArr[that.data.rIndex].user_id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          that.data.commentArr.push({\n            reply_user_id: app.gs('userInfoAll').id,\n            reply_nickname: app.gs('userInfoAll').nickname || '默认用户',\n            reply_is_teach: app.gs('userInfoAll').is_teach || 0,\n            comment: e.detail.value,\n            answer_nickname: that.data.replyName,\n            receiver_user_id: that.data.receiver_user_id,\n            answer_is_teach: that.data.answer_is_teach || 0\n          })\n          that.setData({\n            commentArr: that.data.commentArr\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  // 点赞\n  collectO () {\n    let that = this\n    app.userCollect(that.data.collect, that.data.options.id, that.data.info.user_id, 4).then(() => {\n      that.data.collect ? --that.data.info.collect_count : ++that.data.info.collect_count\n      that.setData({\n        collect: !that.data.collect,\n        info: that.data.info\n      })\n    }, err => {\n      console.log(err)\n    })\n  },\n  onShareAppMessage () {\n    let that = this\n    return {\n      title: '分享了一个问答',\n      path: `/answerPage/pagesthree/answerDetail2/answerDetail2?id=${that.data.options.id}`\n    }\n  },\n  getDetail () {\n    let that = this\n    this.getEvaluate()\n    app.wxrequest({\n      url: app.getUrl().questionDetail,\n      data: {\n        question_id: that.data.options.id,\n        user_id: app.gs('userInfoAll').id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          res.data.data.images = res.data.data.images ? res.data.data.images.split(',') : []\n          res.data.data.create_time = app.momentFormat(res.data.data.create_time * 1000, 'YYYY年MM月DD日 HH:mm:ss')\n          that.setData({\n            collect: res.data.data.is_collect >= 1 ? true : 0,\n            info: res.data.data\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  getEvaluate () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().questionDiscuss,\n      data: {\n        question_id: that.data.options.id,\n        page: ++this.data.page\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          that.setData({\n            commentArr: that.data.commentArr.concat(res.data.data.lists),\n            more: res.data.data.pre_page > res.data.data.lists.length ? 0 : 1\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n\n  showImg (e) {\n    app.showImg(this.data.info.images[e.currentTarget.dataset.index], this.data.info.images)\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    if (!app.gs('userInfoAll')) return app.wxlogin()\n    this.setData({\n      options\n    }, this.getDetail)\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}