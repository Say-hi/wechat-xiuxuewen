{"version":3,"sources":["components/my-tip/my-tip.js"],"names":["app","getApp","dsType","Component","externalClasses","properties","propUser","type","Object","value","user_id","obj_id","index","observer","newValue","oldValue","changePath","_showMask","data","imgDomain","naozai","currentIndex","numArr","methods","_choosePay","e","setData","currentTarget","dataset","userInputValue","_formSubmit","money","detail","that","wxrequest","url","getUrl","reward","key","gs","integral","success","res","wx","hideLoading","code","showToast","title","_close","_closeT","show","triggerEvent","_getUserInfo","info","userInfo","msg","console","warn"],"mappings":"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","file":"my-tip.js","sourcesContent":["// components/component-tag-name.js\r\nconst app = getApp()\r\nconst dsType = {\r\n  'video': 2,\r\n  'answer': 0,\r\n  'article': 1,\r\n  'dynamic': 3,\r\n  'qun': 4,\r\n  'comment': 5\r\n}\r\nComponent({\r\n  externalClasses: ['mask', 'mask-in'],\r\n  properties: {\r\n    propUser: {\r\n      type: Object,\r\n      value: {\r\n        user_id: '默认用户',\r\n        obj_id: -1,\r\n        type: 'video',\r\n        index: -1\r\n      },\r\n      observer (newValue, oldValue, changePath) {\r\n        this._showMask(newValue, oldValue, changePath)\r\n      }\r\n    }\r\n  },\r\n  data: {\r\n    imgDomain: app.data.imgDomain,\r\n    naozai: 'https://c.jiangwenqiang.com/workProject/payKnowledge/naozai.png',\r\n    currentIndex: -1,\r\n    numArr: ['2', '5', '10', '20', '50', '100']\r\n  },\r\n  methods: {\r\n    _choosePay (e) {\r\n      this.setData({\r\n        currentIndex: e.currentTarget.dataset.index,\r\n        userInputValue: this.data.numArr[e.currentTarget.dataset.index]\r\n      })\r\n    },\r\n    _formSubmit (e) {\r\n      // 0：答案；1：文章；2：视频；3：动态\r\n      let { money } = e.detail.value\r\n      let that = this\r\n      app.wxrequest({\r\n        url: app.getUrl().reward,\r\n        data: {\r\n          key: app.gs(),\r\n          integral: money,\r\n          type: dsType[that.data.propUser.type],\r\n          obj_id: that.data.propUser.obj_id\r\n        },\r\n        success (res) {\r\n          wx.hideLoading()\r\n          if (res.data.code === 1) {\r\n            wx.showToast({\r\n              title: '感谢打赏'\r\n            })\r\n            that._close(money || 0)\r\n          } else {\r\n            wx.showToast({\r\n              title: '积分不足'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    _closeT () {\r\n      this._close(0)\r\n    },\r\n    _close (integral) {\r\n      this.setData({\r\n        show: false,\r\n        userInputValue: null,\r\n        currentIndex: -1\r\n      }, this.triggerEvent('ds', {index: this.data.propUser.index, integral: integral}))\r\n    },\r\n    _getUserInfo (newValue) {\r\n      let that = this\r\n      app.wxrequest({\r\n        url: app.getUrl().info,\r\n        data: {\r\n          key: app.gs(),\r\n          user_id: newValue.user_id\r\n        },\r\n        success (res) {\r\n          wx.hideLoading()\r\n          if (res.data.code === 1) {\r\n            that.setData({\r\n              show: true,\r\n              userInfo: res.data.data\r\n            })\r\n          } else {\r\n            wx.showToast({\r\n              title: res.data.msg\r\n            })\r\n            console.warn('错误信息:', res.data.msg)\r\n          }\r\n        }\r\n      })\r\n    },\r\n    _showMask (newValue, oldValue, changePath) {\r\n      // console.log(newValue)\r\n      // let that = this\r\n      if (!newValue) {\r\n        this.setData({\r\n          show: false\r\n        })\r\n      } else {\r\n        this._getUserInfo(newValue)\r\n      }\r\n    }\r\n  }\r\n})\r\n"]}