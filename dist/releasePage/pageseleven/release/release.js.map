{"version":3,"sources":["releasePage/pageseleven/release/release.js"],"names":["app","getApp","COS","require","config","cos","getAuthorization","params","callback","authorization","SecretId","SecretKey","Method","Key","Page","data","compressd","tipsArr","t","testImg","upImgArr","upImgArrProgress","content","onShareAppMessage","title","gs","path","inputValue","e","setData","detail","value","chooseTip","currentTarget","dataset","index","wxUploadImg","that","length","id","wx","chooseImage","count","success","res","tempFilePaths","entries","i","v","temp","real","deleteObject","Bucket","Region","upLoad","j","substr","lastIndexOf","postObject","FilePath","onProgress","info","percent","err","console","error","log","compress","upVideo","speed","upText","size","duration","time","start","Date","getTime","chooseVideo","compressed","tempFilePath","imgOperation","setToast","itemList","showActionSheet","tapIndex","showImg","splice","release","images","push","wxrequest","url","getUrl","questionProblemSub","user_id","context","join","hideLoading","status","showToast","mask","setTimeout","navigateBack","desc","onLoad","options","setBar","type","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"release.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst COS = require('./cos-js-sdk-v5.min')\nconst config = require('./config')\nconst cos = new COS({\n  getAuthorization (params, callback) {\n    let authorization = COS.getAuthorization({\n      SecretId: config.SecretId,\n      SecretKey: config.SecretKey,\n      Method: params.Method,\n      Key: params.Key\n    })\n    callback(authorization)\n  }\n})\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    compressd: true,\n    tipsArr: [\n      {\n        t: 'asdf'\n      },\n      {\n        t: '啊撒旦看风景'\n      }\n    ],\n    testImg: app.data.testImg,\n    upImgArr: [],\n    upImgArrProgress: [],\n    content: 0\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText') || '绣学问，真纹绣',\n      path: `/pages/index/index`\n    }\n  },\n  inputValue (e) {\n    this.setData({\n      content: e.detail.value\n    })\n  },\n  chooseTip (e) {\n    this.data.tipsArr[e.currentTarget.dataset.index]['choose'] = !this.data.tipsArr[e.currentTarget.dataset.index]['choose']\n    this.setData({\n      tipsArr: this.data.tipsArr\n    })\n  },\n  // 上传图片\n  wxUploadImg (index = -1) {\n    let that = this\n    let length = that.data.upImgArr.length || 0\n    let id = app.gs('userInfoAll').id || 10000\n    wx.chooseImage({\n      count: index >= 0 ? 1 : 9 - length,\n      success (res) {\n        for (let [i, v] of res.tempFilePaths.entries()) {\n          if (!that.data.upImgArr[index >= 0 ? index : length + i]) {\n            that.data.upImgArr[index >= 0 ? index : length + i] = {\n              temp: null,\n              real: null\n            }\n          }\n          that.data.upImgArr[index >= 0 ? index : length + i]['real'] = ''\n          that.data.upImgArr[index >= 0 ? index : length + i]['temp'] = v\n        }\n        that.setData({\n          upImgArr: that.data.upImgArr\n        })\n        if (index >= 0) {\n          cos.deleteObject({\n            Bucket: config.Bucket,\n            Region: config.Region,\n            Key: that.data.upImgArr[index].Key\n          })\n        }\n        (function upLoad (j) {\n          let v = res.tempFilePaths[j]\n          let Key = `image/${id}/${v.substr(v.lastIndexOf('/') + 1)}` // 这里指定上传的文件名\n          cos.postObject({\n            Bucket: config.Bucket,\n            Region: config.Region,\n            Key: Key,\n            FilePath: v,\n            onProgress: function (info) {\n              that.data.upImgArrProgress[index >= 0 ? index : length + j] = info.percent * 100\n              that.setData({\n                upImgArrProgress: that.data.upImgArrProgress\n              })\n            }\n          }, (err, data) => {\n            if (err) {\n              console.error('upLoadErr', err)\n              that.data.upImgArr[index >= 0 ? index : length + j]['upFail'] = true\n              that.setData({\n                upImgArr: that.data.upImgArr\n              })\n            } else {\n              console.log(data)\n              that.data.upImgArr[index >= 0 ? index : length + j]['real'] = `https://${config.Bucket}.cos.${config.Region}.myqcloud.com/${Key}`\n              that.data.upImgArr[index >= 0 ? index : length + j]['Key'] = Key\n            }\n            if (j + 1 < res.tempFilePaths.length) upLoad(j + 1)\n          })\n        })(0)\n      }\n    })\n  },\n\n  compress () {\n    this.setData({\n      compressd: !this.data.compressd\n    })\n  },\n  upVideo () {\n    let that = this\n    this.setData({\n      speed: null,\n      upText: '等待上传',\n      size: 0,\n      duration: 0,\n      time: '等待上传任务结束'\n    })\n    let start = new Date().getTime()\n    wx.chooseVideo({\n      compressed: that.data.compressd,\n      success (res) {\n        console.log('chooseSuccess', res)\n        that.setData({\n          duration: res.duration,\n          size: res.size / 1024 > 1024 ? res.size / 1024 / 1024 + 'M' : res.size / 1024 + 'KB'\n        })\n        let v = res.tempFilePath\n        let Key = `video/10000/${v.substr(v.lastIndexOf('/') + 1)}`\n        cos.postObject({\n          Bucket: config.Bucket,\n          Region: config.Region,\n          Key,\n          FilePath: v,\n          onProgress: function (info) {\n            that.setData({\n              upText: '上传中',\n              speed: info.speed / 1024 > 1024 ? info.speed / 1024 / 1024 + 'M/s' : info.speed / 1024 + 'KB/s'\n            })\n          }\n        }, (err, data) => {\n          that.setData({\n            time: (new Date().getTime() - start) / 1000\n          })\n          if (err) {\n            console.error('upLoadErr', err)\n            that.setData({\n              upText: '失败'\n            })\n          } else {\n            console.log('data', data)\n            that.setData({\n              upText: '成功'\n            })\n          }\n        })\n      }\n    })\n  },\n  // 图片操作\n  imgOperation (e) {\n    if (!this.data.upImgArr[e.currentTarget.dataset.index].real) return app.setToast(this, {content: '请稍后操作'})\n    let that = this\n    let itemList = ['查看图片', '替换图片', '删除图片']\n    for (let v of this.data.upImgArr) {\n      if (!v.real) itemList = ['查看图片', '替换图片']\n    }\n    wx.showActionSheet({\n      itemList,\n      success (res) {\n        if (res.tapIndex === 0) {\n          app.showImg(that.data.upImgArr[e.currentTarget.dataset.index].temp, [that.data.upImgArr[e.currentTarget.dataset.index].temp])\n        } else if (res.tapIndex === 2) {\n          cos.deleteObject({\n            Bucket: config.Bucket,\n            Region: config.Region,\n            Key: that.data.upImgArr[e.currentTarget.dataset.index].Key\n          }, () => {\n            that.data.upImgArr.splice(e.currentTarget.dataset.index, 1)\n            that.setData({\n              upImgArr: that.data.upImgArr\n            })\n          })\n        } else if (res.tapIndex === 1) {\n          that.wxUploadImg(e.currentTarget.dataset.index)\n        }\n      }\n    })\n  },\n  release () {\n    let that = this\n    if (!this.data.content) return app.setToast(this, {content: '请输入您的提问内容'})\n    let images = []\n    for (let v of this.data.upImgArr) {\n      images.push(v.real)\n    }\n    app.wxrequest({\n      url: app.getUrl().questionProblemSub,\n      data: {\n        user_id: app.gs('userInfoAll').id,\n        context: that.data.content,\n        images: images.join(',')\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          wx.showToast({\n            title: '发布成功',\n            mask: true\n          })\n          setTimeout(() => {\n            wx.navigateBack({})\n          }, 1000)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    this.setData({\n      options\n    })\n    app.setBar(options.type || '发布问题')\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}