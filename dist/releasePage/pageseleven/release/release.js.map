{"version":3,"sources":["releasePage/pageseleven/release/release.js"],"names":["app","getApp","COS","require","config","cos","getAuthorization","params","callback","authorization","SecretId","SecretKey","Method","Key","Page","data","compressd","tipsArr","t","testImg","upImgArr","upImgArrProgress","content","onShareAppMessage","title","gs","path","imageUrl","g","inputValue","e","setData","detail","value","chooseTip","currentTarget","dataset","index","wxUploadImg","that","length","id","wx","chooseImage","count","success","res","tempFilePaths","entries","i","v","temp","real","deleteObject","Bucket","Region","upLoad","j","substr","lastIndexOf","postObject","FilePath","onProgress","info","percent","err","console","error","log","compress","upVideo","speed","upText","size","duration","time","start","Date","getTime","chooseVideo","compressed","tempFilePath","imgOperation","setToast","itemList","showActionSheet","tapIndex","showImg","splice","release","images","push","wxrequest","url","getUrl","questionProblemSub","user_id","context","join","hideLoading","status","showToast","mask","setTimeout","navigateBack","desc","onLoad","options","setBar","type","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"release.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\nconst COS = require('./cos-js-sdk-v5.min')\nconst config = require('./config')\nconst cos = new COS({\n  getAuthorization (params, callback) {\n    let authorization = COS.getAuthorization({\n      SecretId: config.SecretId,\n      SecretKey: config.SecretKey,\n      Method: params.Method,\n      Key: params.Key\n    })\n    callback(authorization)\n  }\n})\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    compressd: true,\n    tipsArr: [\n      {\n        t: 'asdf'\n      },\n      {\n        t: '啊撒旦看风景'\n      }\n    ],\n    testImg: app.data.testImg,\n    upImgArr: [],\n    upImgArrProgress: [],\n    content: 0\n  },\n  onShareAppMessage () {\n    return {\n      title: app.gs('shareText').t || '绣学问，真纹绣',\n      path: `/pages/index/index`,\n      imageUrl: app.gs('shareText').g\n    }\n  },\n  inputValue (e) {\n    this.setData({\n      content: e.detail.value\n    })\n  },\n  chooseTip (e) {\n    this.data.tipsArr[e.currentTarget.dataset.index]['choose'] = !this.data.tipsArr[e.currentTarget.dataset.index]['choose']\n    this.setData({\n      tipsArr: this.data.tipsArr\n    })\n  },\n  // 上传图片\n  wxUploadImg (index = -1) {\n    let that = this\n    let length = that.data.upImgArr.length || 0\n    let id = app.gs('userInfoAll').id || 10000\n    wx.chooseImage({\n      count: index >= 0 ? 1 : 9 - length,\n      success (res) {\n        for (let [i, v] of res.tempFilePaths.entries()) {\n          if (!that.data.upImgArr[index >= 0 ? index : length + i]) {\n            that.data.upImgArr[index >= 0 ? index : length + i] = {\n              temp: null,\n              real: null\n            }\n          }\n          that.data.upImgArr[index >= 0 ? index : length + i]['real'] = ''\n          that.data.upImgArr[index >= 0 ? index : length + i]['temp'] = v\n        }\n        that.setData({\n          upImgArr: that.data.upImgArr\n        })\n        if (index >= 0) {\n          cos.deleteObject({\n            Bucket: config.Bucket,\n            Region: config.Region,\n            Key: that.data.upImgArr[index].Key\n          })\n        }\n        (function upLoad (j) {\n          let v = res.tempFilePaths[j]\n          let Key = `image/${id}/${v.substr(v.lastIndexOf('/') + 1)}` // 这里指定上传的文件名\n          cos.postObject({\n            Bucket: config.Bucket,\n            Region: config.Region,\n            Key: Key,\n            FilePath: v,\n            onProgress: function (info) {\n              that.data.upImgArrProgress[index >= 0 ? index : length + j] = info.percent * 100\n              that.setData({\n                upImgArrProgress: that.data.upImgArrProgress\n              })\n            }\n          }, (err, data) => {\n            if (err) {\n              console.error('upLoadErr', err)\n              that.data.upImgArr[index >= 0 ? index : length + j]['upFail'] = true\n              that.setData({\n                upImgArr: that.data.upImgArr\n              })\n            } else {\n              console.log(data)\n              that.data.upImgArr[index >= 0 ? index : length + j]['real'] = `https://${config.Bucket}.cos.${config.Region}.myqcloud.com/${Key}`\n              that.data.upImgArr[index >= 0 ? index : length + j]['Key'] = Key\n            }\n            if (j + 1 < res.tempFilePaths.length) upLoad(j + 1)\n          })\n        })(0)\n      }\n    })\n  },\n\n  compress () {\n    this.setData({\n      compressd: !this.data.compressd\n    })\n  },\n  upVideo () {\n    let that = this\n    this.setData({\n      speed: null,\n      upText: '等待上传',\n      size: 0,\n      duration: 0,\n      time: '等待上传任务结束'\n    })\n    let start = new Date().getTime()\n    wx.chooseVideo({\n      compressed: that.data.compressd,\n      success (res) {\n        console.log('chooseSuccess', res)\n        that.setData({\n          duration: res.duration,\n          size: res.size / 1024 > 1024 ? res.size / 1024 / 1024 + 'M' : res.size / 1024 + 'KB'\n        })\n        let v = res.tempFilePath\n        let Key = `video/10000/${v.substr(v.lastIndexOf('/') + 1)}`\n        cos.postObject({\n          Bucket: config.Bucket,\n          Region: config.Region,\n          Key,\n          FilePath: v,\n          onProgress: function (info) {\n            that.setData({\n              upText: '上传中',\n              speed: info.speed / 1024 > 1024 ? info.speed / 1024 / 1024 + 'M/s' : info.speed / 1024 + 'KB/s'\n            })\n          }\n        }, (err, data) => {\n          that.setData({\n            time: (new Date().getTime() - start) / 1000\n          })\n          if (err) {\n            console.error('upLoadErr', err)\n            that.setData({\n              upText: '失败'\n            })\n          } else {\n            console.log('data', data)\n            that.setData({\n              upText: '成功'\n            })\n          }\n        })\n      }\n    })\n  },\n  // 图片操作\n  imgOperation (e) {\n    if (!this.data.upImgArr[e.currentTarget.dataset.index].real) return app.setToast(this, {content: '请稍后操作'})\n    let that = this\n    let itemList = ['查看图片', '替换图片', '删除图片']\n    for (let v of this.data.upImgArr) {\n      if (!v.real) itemList = ['查看图片', '替换图片']\n    }\n    wx.showActionSheet({\n      itemList,\n      success (res) {\n        if (res.tapIndex === 0) {\n          app.showImg(that.data.upImgArr[e.currentTarget.dataset.index].temp, [that.data.upImgArr[e.currentTarget.dataset.index].temp])\n        } else if (res.tapIndex === 2) {\n          cos.deleteObject({\n            Bucket: config.Bucket,\n            Region: config.Region,\n            Key: that.data.upImgArr[e.currentTarget.dataset.index].Key\n          }, () => {\n            that.data.upImgArr.splice(e.currentTarget.dataset.index, 1)\n            that.setData({\n              upImgArr: that.data.upImgArr\n            })\n          })\n        } else if (res.tapIndex === 1) {\n          that.wxUploadImg(e.currentTarget.dataset.index)\n        }\n      }\n    })\n  },\n  release () {\n    let that = this\n    if (!this.data.content) return app.setToast(this, {content: '请输入您的提问内容'})\n    let images = []\n    for (let v of this.data.upImgArr) {\n      images.push(v.real)\n    }\n    app.wxrequest({\n      url: app.getUrl().questionProblemSub,\n      data: {\n        user_id: app.gs('userInfoAll').id,\n        context: that.data.content,\n        images: images.join(',')\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          wx.showToast({\n            title: '发布成功',\n            mask: true\n          })\n          setTimeout(() => {\n            wx.navigateBack({})\n          }, 1000)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    this.setData({\n      options\n    })\n    app.setBar(options.type || '发布问题')\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    // TODO: onPullDownRefresh\n  }\n})\n"]}