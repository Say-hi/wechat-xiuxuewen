{"version":3,"sources":["storePage/pagesstore/messagePage/messageDetail/messageDetail.js"],"names":["app","getApp","Page","data","testImg","page","sysIndex","lists","getSys","that","wxrequest","url","getUrl","teacherUserSysDetail","id","success","res","wx","hideLoading","status","create_time","momentFormat","WP","context","setData","sysInfo","setToast","content","desc","goDetail","e","currentTarget","dataset","type","console","log","index","navigateTo","getList","options","user_id","gs","v","concat","more","pre_page","length","onReachBottom","onLoad","setBar","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"messageDetail.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    testImg: app.data.testImg,\n    page: 0,\n    sysIndex: -1,\n    lists: []\n  },\n  getSys () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().teacherUserSysDetail,\n      data: {\n        id: that.data.lists[that.data.sysIndex].id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          res.data.data.create_time = app.momentFormat(res.data.data.create_time * 1000, 'YYYY年MM月DD日 HH:MM')\n          app.WP('desc', 'html', res.data.data.context, that, 30)\n          that.setData({\n            sysInfo: res.data.data\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  goDetail (e) {\n    if (e.currentTarget.dataset.type === 'close') {\n      return this.setData({\n        sysIndex: -1\n      })\n    }\n    if (e.currentTarget.dataset.type === 'sys') {\n      console.log(1)\n      this.setData({\n        sysIndex: e.currentTarget.dataset.index\n      }, this.getSys)\n    } else {\n      wx.navigateTo({\n        url: `/coursePage/pageszero/courseDetail/courseDetail?id=${e.currentTarget.dataset.id}&type=1`\n      })\n    }\n  },\n  getList () {\n    let that = this\n    let type = this.data.options.type\n    app.wxrequest({\n      url: app.getUrl()[type === '系统通知' ? 'teacherUserSys' : type === '评论' ? 'teacherUserEvaluateMsg' : 'teacherUserVideoCollect'],\n      data: {\n        user_id: app.gs('userInfoAll').id,\n        page: ++this.data.page\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          for (let v of res.data.data.lists) {\n            v.create_time = app.momentFormat(v.create_time * 1000, 'YYYY年MM月DD日 HH:MM')\n          }\n          that.setData({\n            lists: that.data.lists.concat(res.data.data.lists),\n            more: res.data.data.pre_page > res.data.data.lists.length ? 0 : 1\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  onReachBottom () {\n    if (this.data.more >= 1) this.getList()\n    else app.setToast(this, {content: '没有更多内容啦'})\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    this.setData({\n      options\n    }, this.getList)\n    app.setBar(options.type)\n    // TODO: onLoad\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    // TODO: onReady\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    // TODO: onShow\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    // TODO: onHide\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    this.data.page = 0\n    this.data.lists = []\n    this.getList()\n    // TODO: onPullDownRefresh\n  }\n})\n"]}