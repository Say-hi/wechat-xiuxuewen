{"version":3,"sources":["shopPage/shoppages/index/index.js"],"names":["app","getApp","Page","data","img","testImg","labelIndex","inputValue","e","searchText","detail","value","getVideo","that","wxrequest","url","getUrl","shopVideoList","success","res","wx","hideLoading","stopPullDownRefresh","status","setData","list","lists","getCategory","setToast","content","desc","shopCategoryList","goodslabel","shopInfo","su","getShopProduct","name","search","shopProductList","mid","cid","id","goods","chooseLabel","currentTarget","dataset","index","length","title","unshift","gs","info","upFormId","noUse","playVideo","videoCount","play","playIndex","onShareAppMessage","imageUrl","avatar","path","onLoad","options","showModal","showCancel","reLaunch","wxlogin","onReady","onShow","move","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"index.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    img: app.data.testImg,\n    labelIndex: 0\n  },\n  inputValue (e) {\n    this.data.searchText = e.detail.value\n  },\n  getVideo () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().shopVideoList,\n      data: {},\n      success (res) {\n        wx.hideLoading()\n        wx.stopPullDownRefresh()\n        if (res.data.status === 200) {\n          that.setData({\n            list: res.data.data.lists\n          }, that.getCategory)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  getCategory () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().shopCategoryList,\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          that.setData({\n            goodslabel: res.data.data\n          }, that.shopInfo)\n          app.su('shopLabel', res.data.data)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  getShopProduct () {\n    let that = this\n    if (this.data.goodslabel[this.data.labelIndex].name === '搜索') return this.search()\n    app.wxrequest({\n      url: app.getUrl().shopProductList,\n      data: {\n        mid: 0,\n        cid: that.data.goodslabel[that.data.labelIndex].id\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          that.setData({\n            goods: res.data.data.lists\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  chooseLabel (e) {\n    this.setData({\n      goodslabel: this.data.goodslabel,\n      labelIndex: e.currentTarget.dataset.index\n    }, this.getShopProduct)\n  },\n  search () {\n    let that = this\n    if (!this.data.searchText || this.data.searchText.length <= 0) return app.setToast(this, {content: '请输入搜索的内容'})\n    app.wxrequest({\n      url: app.getUrl().shopProductList,\n      data: {\n        mid: 0,\n        title: that.data.searchText\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          if (that.data.goodslabel[0].name !== '搜索') {\n            that.data.goodslabel.unshift({\n              name: '搜索'\n            })\n          }\n          that.setData({\n            labelIndex: 0,\n            goodslabel: that.data.goodslabel,\n            goods: res.data.data.lists\n          })\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  shopInfo () {\n    let that = this\n    app.wxrequest({\n      url: app.getUrl().shopInfo,\n      data: {\n        mid: app.gs('shopInfo').mid || 1\n      },\n      success (res) {\n        wx.hideLoading()\n        if (res.data.status === 200) {\n          if (!app.gs('shopInfoAll')) {\n            app.su('shopInfoAll', res.data.data)\n          }\n          that.setData({\n            info: res.data.data\n          }, that.getShopProduct)\n        } else {\n          app.setToast(that, {content: res.data.desc})\n        }\n      }\n    })\n  },\n  upFormId (e) {\n    app.upFormId(e)\n  },\n  noUse () {\n    app.noUse()\n  },\n  playVideo (e) {\n    let that = this\n    if (e.currentTarget.dataset.index >= 0) app.videoCount(this.data.list[e.currentTarget.dataset.index].id)\n    this.setData({\n      play: !that.data.play,\n      playIndex: e.currentTarget.dataset.index\n    })\n  },\n  onShareAppMessage () {\n    let that = this\n    return {\n      title: `向您推荐店铺【${that.data.info.name}】`,\n      imageUrl: `${that.data.info.avatar || ''}`,\n      path: `/shopPage/shoppages/index/index?mid=${that.data.id}`\n    }\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad (options) {\n    if (!app.gs('shopInfo').mid) {\n      app.su('shopInfo', options)\n      if (!app.gs('shopInfo').mid) {\n        wx.showModal({\n          title: '进入错误',\n          content: '请扫码店主的【小程序码】或从【店主分享】进入',\n          showCancel: false,\n          success () {\n            wx.reLaunch({\n              url: '/pages/index/index'\n            })\n          }\n        })\n      }\n    }\n    if (!app.gs() || !app.gs('userInfoAll')) return app.wxlogin()\n    this.getVideo()\n  },\n\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n  },\n\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    this.setData({\n      move: !this.data.move\n    })\n  },\n\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    this.setData({\n      move: !this.data.move\n    })\n  },\n\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    // TODO: onUnload\n  },\n\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    this.getVideo()\n  }\n})\n"]}